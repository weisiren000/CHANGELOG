# hosAgent v0.0.47 (2026-01-06)

## 变更概览

- 重构测试聊天模块：从 chat 目录迁移至 test-chat，优化组件结构
- 新增 AI 工具列表功能：后端支持获取可用工具列表，前端展示工具列表
- 重构媒体上传 hooks：增强文件类型支持，提取工具函数到 utils
- 优化 AI 配置保存逻辑：支持 ASR 相关字段
- 更新架构文档：反映新的目录结构和 API 端点

## 详情

### Added
- 新增后端 API 端点 `/api/tools`：获取可用的 AI 工具列表，支持工具参数 Schema
- 新增 `frontend/src/app/console/AIToolsList.tsx`：AI 工具列表组件，显示可用工具
- 新增 `frontend/src/app/console/test-chat/` 目录：
  - `TestChatPage.tsx`：测试聊天页面入口
  - `components/ChatPanel.tsx`：聊天面板组件（会话列表+消息+输入）
  - `components/ConfigSummary.tsx`：配置摘要组件
  - `components/EmptyConfigState.tsx`：空配置状态组件
  - `hooks/useConfig.ts`：配置加载 hook
  - `hooks/utils/`：工具函数目录
    - `index.ts`：工具函数统一导出
    - `mediaValidation.ts`：媒体验证工具
    - `requestBuilder.ts`：聊天请求构建工具
    - `streamParser.ts`：流式响应解析工具

### Changed
- 重构 `frontend/src/app/console/chat/` 至 `frontend/src/app/console/test-chat/`：
  - 优化目录结构和组件组织
  - 提取配置逻辑到独立 hook（useConfig）
  - 将媒体上传相关代码迁移至 test-chat 模块
- 重构 `frontend/src/app/console/AIConfig/`：
  - 重命名 `AIConfigPanel.tsx` 为 `AIConfigPage.tsx`
  - 更新模块导出，统一组件入口
- 优化 `frontend/src/app/console/ConfigSelector.tsx`：
  - 支持保存和加载 ASR 相关配置（asrModel、asrApiKey）
- 优化 `frontend/src/app/console/QuickTools.tsx`：简化快捷操作卡片，移除未实现按钮
- 更新后端 `backend/src/index.ts`：
  - 导入并注册工具注册器（toolRegistry）
  - 添加工具参数属性 Schema 定义（支持类型、描述、默认值等）
  - 实现 /api/tools 端点，返回工具定义列表
- 更新 `frontend/src/app/main/hooks/useMediaUpload.ts` 和 `frontend/src/app/main/utils/uploadUtils.ts`：优化代码格式
- 更新 `.kiro/steering/architecture.md`：反映 test-chat 模块的新目录结构
- 更新 `.kiro/steering/backend.md`：添加 /api/tools 端点文档

### Removed
- 移除 `frontend/src/app/console/chat/` 目录（已迁移至 test-chat/）
- 移除 `frontend/src/app/console/test-chat/page.tsx`（已迁移至 TestChatPage.tsx）

### Technical
- 组件模块化设计：测试聊天模块按功能拆分为 components/hooks/utils
- 工具函数复用：提取媒体验证、请求构建、流式解析等通用工具函数
- 类型安全：工具参数 Schema 使用 zod 定义，确保类型安全
- API 规范：/api/tools 端点返回符合 OpenAI 函数调用格式的工具定义
- 代码格式统一：优化换行符处理（LF/CRLF）
- 模块导出规范：各子模块通过 index.ts 统一导出，保持清晰的模块边界

## Technical Details

- Commit: `aef278d` - feat(chat): 重构测试聊天模块并添加 AI 工具列表功能 (2026-01-06)
